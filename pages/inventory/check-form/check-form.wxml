<view class="page">
  <view class="form">
    <view class="group">
      <view class="label">备注</view>
      <input class="input" placeholder="选填" value="{{remark}}" bindinput="onRemarkInput" />
    </view>
  </view>

  <view class="section">
    <view class="section-header">
      <text class="title">盘点明细</text>
      <view class="add-btn" bindtap="onAddProduct">+ 添加商品</view>
    </view>
    <view class="item-list" wx:if="{{items.length > 0}}">
      <view class="item" wx:for="{{items}}" wx:key="sku_id">
        <view class="item-name">{{item.product_name}} <text class="size-tag" wx:if="{{item.size}}">{{item.size}}码</text></view>
        <view class="item-row">
          <text>账面库存</text>
          <text class="readonly">{{item.book_stock}}</text>
        </view>
        <view class="item-row">
          <text>实际库存</text>
          <input type="number" value="{{item.actual_stock}}" data-index="{{index}}" bindinput="onActualInput" />
        </view>
        <view class="item-row">
          <text>差异</text>
          <text class="diff {{item._diffClass}}">{{item._diff}}</text>
        </view>
        <view class="item-footer">
          <text class="remove" bindtap="onRemoveItem" data-index="{{index}}">删除</text>
        </view>
      </view>
    </view>
    <view class="empty-tip" wx:else>点击上方添加商品</view>
  </view>

  <view class="actions">
    <button class="btn btn-cancel" bindtap="onCancel">取消</button>
    <button class="btn btn-submit" loading="{{submitting}}" disabled="{{submitting}}" bindtap="onSubmit">提交</button>
  </view>
</view>
