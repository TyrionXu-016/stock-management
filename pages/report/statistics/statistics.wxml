<view class="page">
  <view class="date-bar">
    <picker mode="date" value="{{startDate}}" bindchange="onDateStartChange">
      <view class="date-item">{{startDate}}</view>
    </picker>
    <text class="sep">至</text>
    <picker mode="date" value="{{endDate}}" bindchange="onDateEndChange">
      <view class="date-item">{{endDate}}</view>
    </picker>
  </view>

  <view class="group-bar" wx:if="{{type !== 'turnover'}}">
    <picker mode="selector" range="{{groupByOpts}}" range-key="label" value="{{groupByIndex}}" bindchange="onGroupByChange">
      <view class="group-item">{{groupByOpts[groupByIndex].label}}</view>
    </picker>
  </view>

  <scroll-view class="list-scroll" scroll-y>
    <view class="list" wx:if="{{list.length > 0}}">
      <view class="item" wx:for="{{list}}" wx:key="product_id">
        <view class="item-name">{{item.product_name || item.category_name || item.date}}</view>
        <view class="item-row" wx:if="{{type !== 'turnover'}}">
          <text>数量 {{item.total_quantity || 0}}</text>
          <text>金额 ¥{{item.total_amount || '0.00'}}</text>
        </view>
        <view class="item-row" wx:if="{{type === 'turnover'}}">
          <text>平均库存 {{item.avg_stock || 0}}</text>
          <text>出库 {{item.outbound_quantity || 0}}</text>
          <text>周转率 {{item.turnover_rate || 0}}</text>
        </view>
      </view>
    </view>
    <view class="empty" wx:else>暂无数据</view>
  </scroll-view>
</view>
